import { M as SessionContext, E as EmptyPublicData, I as IsAuthorizedArgs, N as AuthenticatedSessionContext, P as PublicData } from './index-834e37b5.js';
export { k as AuthClientPlugin, A as AuthPluginClientOptions, V as AuthPluginOptions, W as AuthServerPlugin, F as AuthenticatedClientSession, N as AuthenticatedSessionContext, O as BlitzCtx, B as BlitzPage, C as COOKIE_ANONYMOUS_SESSION_TOKEN, q as COOKIE_CSRF_TOKEN, r as COOKIE_PUBLIC_DATA_TOKEN, o as COOKIE_REFRESH_TOKEN, n as COOKIE_SESSION_TOKEN, D as ClientSession, E as EmptyPublicData, H as HANDLE_SEPARATOR, s as HEADER_CSRF, w as HEADER_CSRF_ERROR, t as HEADER_PUBLIC_DATA_TOKEN, v as HEADER_SESSION_CREATED, I as IsAuthorizedArgs, x as LOCALSTORAGE_CSRF_TOKEN, L as LOCALSTORAGE_PREFIX, y as LOCALSTORAGE_PUBLIC_DATA_TOKEN, Q as PrismaStorage, P as PublicData, R as RedirectAuthenticatedTo, i as RedirectAuthenticatedToFn, h as RedirectAuthenticatedToFnCtx, m as SESSION_TOKEN_VERSION_0, l as SESSION_TYPE_ANONYMOUS_JWT, S as SESSION_TYPE_OPAQUE_TOKEN_SIMPLE, z as Session, J as SessionConfigMethods, M as SessionContext, K as SessionContextBase, G as SessionModel, T as TOKEN_SEPARATOR, U as UseSessionOptions, b as backupAntiCSRFTokenToLocalStorage, a as getAntiCSRFToken, j as getAuthValues, g as getPublicDataStore, p as parsePublicDataToken, e as useAuthenticatedSession, d as useAuthorize, c as useAuthorizeIf, f as useRedirectAuthenticated, u as useSession } from './index-834e37b5.js';
import { IncomingMessage, ServerResponse } from 'http';
import { Ctx, MiddlewareResponse } from 'blitz';
import { AuthenticateOptions, Strategy } from 'passport';
import 'bad-behavior';
import 'url';
import 'react';

declare function isLocalhost(req: any): boolean;
/**
 * Parse cookies from the `headers` of request
 * @param req request object
 */
declare function getCookieParser(headers: {
    [key: string]: undefined | string | string[];
}): () => {
    [key: string]: string;
};
interface SimpleRolesIsAuthorized<RoleType = string> {
    ({ ctx, args }: {
        ctx: any;
        args: [roleOrRoles?: RoleType | RoleType[]];
    }): boolean;
}
declare const simpleRolesIsAuthorized: SimpleRolesIsAuthorized;
declare type JwtPayload = AnonymousSessionPayload | null;
declare type AnonSessionKernel = {
    handle: string;
    publicData: EmptyPublicData;
    jwtPayload: JwtPayload;
    antiCSRFToken: string;
    anonymousSessionToken: string;
};
declare type AuthedSessionKernel = {
    handle: string;
    publicData: PublicData;
    jwtPayload: JwtPayload;
    antiCSRFToken: string;
    sessionToken: string;
};
declare type SessionKernel = AnonSessionKernel | AuthedSessionKernel;
declare function getSession(req: IncomingMessage, res: ServerResponse): Promise<SessionContext>;
declare class SessionContextClass implements SessionContext {
    private _req;
    private _res;
    private _kernel;
    constructor(req: IncomingMessage & {
        cookies: {
            [key: string]: string;
        };
    }, res: ServerResponse & {
        blitzCtx: Ctx;
    }, kernel: SessionKernel);
    get $handle(): string;
    get userId(): unknown;
    get $publicData(): {
        userId: unknown;
        role?: unknown;
    } | EmptyPublicData;
    $authorize(...args: IsAuthorizedArgs): void;
    $isAuthorized(...args: IsAuthorizedArgs): boolean;
    $thisIsAuthorized(...args: IsAuthorizedArgs): this is AuthenticatedSessionContext;
    $create(publicData: PublicData, privateData?: Record<any, any>): Promise<void>;
    $revoke(): Promise<void>;
    $revokeAll(): Promise<void>;
    $setPublicData(data: Record<any, any>): Promise<void>;
    $getPrivateData(): Promise<Record<any, any>>;
    $setPrivateData(data: Record<any, any>): Promise<void>;
}
declare type AnonymousSessionPayload = {
    isAnonymous: true;
    handle: string;
    publicData: EmptyPublicData;
    antiCSRFToken: string;
};
declare const setCookie: (res: ServerResponse, cookieStr: string) => void;
declare function getAllSessionHandlesForUser(userId: PublicData["userId"]): Promise<string[]>;
/**
 * Updates publicData in all sessions
 *
 * @param {PublicData["userId"]} userId
 * @param {Record<any, any>} data
 */
declare function setPublicDataForUser(userId: PublicData["userId"], data: Record<any, any>): Promise<void>;

declare const hash256: (input?: string) => string;
declare const generateToken: (numberOfCharacters?: number) => string;
declare const SecurePassword: {
    hash(password: string | null | undefined): Promise<string>;
    verify(hashedPassword: string | null | undefined, password: string | null | undefined): Promise<symbol>;
    HASH_BYTES: number;
    INVALID: symbol;
    INVALID_UNRECOGNIZED_HASH: symbol;
    MEMLIMIT_DEFAULT: number;
    MEMLIMIT_MAX: number;
    MEMLIMIT_MIN: number;
    OPSLIMIT_DEFAULT: number;
    OPSLIMIT_MAX: number;
    OPSLIMIT_MIN: number;
    PASSWORD_BYTES_MAX: number;
    PASSWORD_BYTES_MIN: number;
    VALID: symbol;
    VALID_NEEDS_REHASH: symbol;
};

interface BlitzPassportConfigCallbackParams {
    ctx: Ctx;
    req: IncomingMessage;
    res: ServerResponse;
}
declare type BlitzPassportConfigCallback = ({ ctx, req, res, }: BlitzPassportConfigCallbackParams) => BlitzPassportConfigObject;
declare type BlitzPassportConfig = BlitzPassportConfigObject | BlitzPassportConfigCallback;
declare type BlitzPassportStrategy = {
    name?: string;
    authenticateOptions?: AuthenticateOptions;
    strategy: Strategy;
};
declare type BlitzPassportConfigObject = {
    successRedirectUrl?: string;
    errorRedirectUrl?: string;
    strategies: BlitzPassportStrategy[];
    secureProxy?: boolean;
};
declare type VerifyCallbackResult = {
    publicData: PublicData;
    privateData?: Record<string, unknown>;
    redirectUrl?: string;
};
declare type ApiHandlerIncomingMessage = IncomingMessage & {
    query: {
        [key: string]: string | string[] | undefined;
    };
};
declare type ApiHandler = (req: ApiHandlerIncomingMessage, res: MiddlewareResponse & {
    status: (statusCode: number) => any;
}) => void | Promise<void>;
declare function passportAuth(config: BlitzPassportConfig): ApiHandler;

export { AnonymousSessionPayload, ApiHandler, ApiHandlerIncomingMessage, BlitzPassportConfig, BlitzPassportConfigCallback, BlitzPassportConfigCallbackParams, BlitzPassportConfigObject, BlitzPassportStrategy, SecurePassword, SessionContextClass, SimpleRolesIsAuthorized, VerifyCallbackResult, generateToken, getAllSessionHandlesForUser, getCookieParser, getSession, hash256, isLocalhost, passportAuth, setCookie, setPublicDataForUser, simpleRolesIsAuthorized };
